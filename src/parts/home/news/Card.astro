---
import clsx from 'clsx';
import Button from '../../../components/Button/Button.astro';
import Icon from '../../../components/icon/Icon.astro';
import styles from './Card.module.css'

const { data, isPriority = false } = Astro.props;

const buildSrcSet = (src: string) => {
  if (!src.endsWith(".webp")) return undefined;
  const base = src.endsWith("-660.webp")
    ? src.replace(/-660\.webp$/, "")
    : src.replace(/\.webp$/, "");
  return [
    `${base}-360.webp 360w`,
    `${base}-720.webp 720w`,
    `${src} 660w`,
  ].join(", ");
};

const srcSet = buildSrcSet(data.image);
const sizes =
  "(max-width: 767px) 90vw, (max-width: 1023px) 45vw, 338px";
---

<div class={styles.card}>
    <div class={styles.card__image}>     
      <img
        src={data.image}
        srcset={srcSet}
        sizes={srcSet ? sizes : undefined}
        loading="eager"
        decoding="async"
        fetchpriority="high"
        width="338"
        height="200"
        alt={data.title}
      />
    </div>
    <div class={styles.card__content}>
      <p class={clsx(
        'text__body--14-medium-uppercase',
        'text__body--14-medium-uppercase-lg',
        'text__body--12-medium-uppercase-md',
        styles.card__newsname
      )}>
        {data.newsname}
      </p>
      
      <h3 class=
        'text__heading--h6
        text__heading--h5-lg
        text__heading--h6-md',
      >
        {data.title}
      </h3>
      <div class={clsx(
        'text__body--14',
        'text__body--14-lg',
        'text__caption--md',
        styles.card__text
      )}>
        <slot />
      </div>
    </div>
  
    <Button 
      variant="tertiary" 
      size="tert"
      href={data.buttonLink} 
      class={styles.card__btn}
    >
      <span 
      class="text__body--16-semibold" 
      style={{ color: 'var(--color-black)' }}
      >
        Start now
      </span>
      <Icon 
        name="arrow-right" 
        width={24} 
        height={24} 
        var(--color-orange-500)
       />
    </Button>
</div>
